(function() {
	'use strict';

	Lampa.Platform.tv();

	// Удалены 'Lampa32' и 'bylampa' из обфусцированного массива
	function _0x4ba1(){var _0x3d5e7c=['jacred.xyz','div[data-children="parser"]','bind','trace','no_parser','viewbox','component','open','title','url','34DPECDY','settings-folder','jac_black','jackett_interview','5178915kmzeLa','Свой вариант','{}.constructor("return this")(', '(((.+)+)+)+$','Ошибка доступа','color','onload','select','Jacred Pro','disconnect','follow','prototype','listener','jac_lang','send','field','1585WkmKSL','then','ff2121','div[data-name="jackett_urltwo"]','div[data-name="parser_torrent_type"]','jackett','Jacred RU','Storage','64e364','.settings-param__name','addParam','parser','back','observe','hide','https:','html','search','Viewbox','3uZaIdP','Error:','onerror','body','jacblack.ru:9117','jack','toString','table','return (function() ','getItem','Controller','https://','jac_key','set','jacred_ru','Manifest','error','ontimeout','1740483EYPCGH','remove','activity','origin','Меню смены парсера','2549108GXBsOJ','constructor','toggle','parse_lang','active','/api/v2.0/indexers/status:healthy/results?apikey=','find','torrents','settings_component','insertAfter','div[data-name="jackett_url"]','jacred.pro','healthy','apply','Activity','change','parser_use','8cckJLI','timeout','62.60.149.237:8443','jackett_url','css','http://','777','console','jac_int','parse_in_search','Jacred.xyz','jackett_urltwo','parser_torrent_type','<span style="color: #ff2121;">✘  ','status','length','jr.maxvol.pro','__proto__','enabled','2535460LHrtQb','jacred.viewbox.dev','Jac Black','[data-name="jackett_url_two"]','exception','false','Settings','protocol','GET','</span>','694650NDDjwG','jacred_pro','.empty__title','jac-red.ru','get','all','url_two','Нажмите для выбора парсера из списка','update','ffffff','Select','name','div[data-name="jackett_key"]','000','73137BJrqRR','push','map','show','history','Jacred Maxvol Pro','jr_maxvol_pro','SettingsApi','✘  ','Noty','text','log','jackett_key','✔  ','jacred_xyz','1050jMpdcL'];_0x4ba1=function(){return _0x3d5e7c;};return _0x4ba1();}

	function _0x17ce(_0x33037b,_0x831518){var _0x210fe0=_0x4ba1();return _0x17ce=function(_0x5d7ddd,_0xda1cad){_0x5d7ddd=_0x5d7ddd-0x142;var _0x3d2b1=_0x210fe0[_0x5d7ddd];return _0x3d2b1;},_0x17ce(_0x33037b,_0x831518);}

	(function(_0x3ca4b4,_0x414211){var _0xa54d2a=_0x17ce,_0x57c970=_0x3ca4b4();while(!![]){try{var _0x2bdd46=parseInt(_0xa54d2a(0x186))/0x1*(parseInt(_0xa54d2a(0x1a1))/0x2)+-parseInt(_0xa54d2a(0x1ca))/0x3*(-parseInt(_0xa54d2a(0x147))/0x4)+parseInt(_0xa54d2a(0x1b7))/0x5*(-parseInt(_0xa54d2a(0x196))/0x6)+-parseInt(_0xa54d2a(0x1a6))/0x7+-parseInt(_0xa54d2a(0x15a))/0x8*(parseInt(_0xa54d2a(0x142))/0x9)+-parseInt(_0xa54d2a(0x16d))/0xa+parseInt(_0xa54d2a(0x177))/0xb;if(_0x2bdd46===_0x414211)break;else _0x57c970['push'](_0x57c970['shift']());}catch(_0x117bce){_0x57c970['push'](_0x57c970['shift']());}}}(_0x4ba1,0xab43f),

	(function(){
		var _0x583357=_0x17ce,
		_0xe80072=(function(){var _0x350dcd=!![];return function(_0x3034cb,_0x1a4ac6){var _0x5aa910=_0x350dcd?function(){if(_0x1a4ac6){var _0x4f0cec=_0x1a4ac6[_0x17ce(0x156)](_0x3034cb,arguments);return _0x1a4ac6=null,_0x4f0cec;}}:function(){};return _0x350dcd=![],_0x5aa910;};}()),
		_0x2e6716=_0xe80072(this,function(){var _0x2eb0ee=_0x17ce;return _0x2e6716[_0x2eb0ee(0x1d0)]()[_0x2eb0ee(0x1c8)](_0x2eb0ee(0x1a9))[_0x2eb0ee(0x1d0)]()['constructor'](_0x2e6716)[_0x2eb0ee(0x1c8)](_0x2eb0ee(0x1a9));});_0x2e6716();

		'use strict';
		Lampa[_0x583357(0x1be)][_0x583357(0x1d7)](_0x583357(0x159),!![]);

		var _0x1d3543=location['protocol']===_0x583357(0x1c6)?'https://':'http://',
			_0x5e1e8d=['jacred.pro','jr.maxvol.pro','jac-red.ru','jacred.viewbox.dev','jacred.pro','jacblack.ru:9117'],
			_0x56a111=['Jacred.xyz','Jacred Maxvol Pro','Jacred RU','Viewbox','Jacred Pro','Jac Black'];

		function _0x792fcb(_0x558e43){
			setTimeout(function(){
				var _0x4261d5=_0x17ce,
					_0x522237='';
				if(_0x5e1e8d[_0x558e43]=='jacblack.ru:9117')_0x522237='777';
				var _0x2e842a=_0x558e43+2;
				if(_0x5e1e8d[_0x558e43]=='jr.maxvol.pro')_0x1d3543='https://';
				else _0x1d3543='http://';

				var _0x89274d='body > div.selectbox > div.selectbox__content.layer--height > div.selectbox__body.layer--wheight > div > div > div > div:nth-child('+_0x2e842a+') > div';
				if($('body > div.selectbox > div.selectbox__content.layer--height > div.selectbox__body.layer--wheight > div > div > div > div:nth-child(1) > div').text()!=='Свой вариант')return;

				var _0x5ce41f=_0x1d3543+_0x5e1e8d[_0x558e43]+'/api/v2.0/indexers/status:healthy/results?apikey='+_0x522237,
					_0x18fc95=new XMLHttpRequest();
				_0x18fc95.timeout=3000;
				_0x18fc95.open('GET',_0x5ce41f,true);
				_0x18fc95.send();
				_0x18fc95.ontimeout=function(){
					if($(_0x89274d).text()==_0x56a111[_0x558e43])$(_0x89274d).html('<span style="color: #ff2121;">✘  '+$(_0x89274d).text()+'</span>').css('color','#ff2121');
				};
				_0x18fc95.onerror=function(){
					if($(_0x89274d).text()==_0x56a111[_0x558e43])$(_0x89274d).html('<span style="color: #ff2121;">✘  '+$(_0x89274d).text()+'</span>').css('color','#ff2121');
				};
				_0x18fc95.onload=function(){
					if(_0x18fc95.status==200){
						if($(_0x89274d).text()==_0x56a111[_0x558e43])$(_0x89274d).html('✔  '+$(_0x89274d).text()).css('color','#64e364');
					}else{
						if($(_0x89274d).text()==_0x56a111[_0x558e43])$(_0x89274d).html('<span style="color: #ff2121;">✘  '+$(_0x89274d).text()+'</span>').css('color','#ff2121');
					}
				};
			},1000);
		}

		function _0x188075(){
			for(var _0x5db083=0;_0x5db083<_0x5e1e8d.length;_0x5db083++){
				_0x792fcb(_0x5db083);
			}
		}

		Lampa.Listener.follow('app',function(_0x516ded){
			if(_0x516ded.name=='parser')setTimeout(_0x188075,10);
		});

		function _0x4d128a(){
			if(Lampa.Storage.get('jackett_urltwo')=='no_parser'){
				Lampa.Storage.set('jackett_url','');
				Lampa.Storage.set('jackett_key','');
				Lampa.Storage.set('jackett_interview','false');
				Lampa.Storage.set('parse_in_search',false);
				Lampa.Storage.set('parse_lang','lg');
			}
			if(Lampa.Storage.get('jackett_urltwo')=='jacred_xyz'){
				Lampa.Storage.set('jackett_url','jacred.pro');
				Lampa.Storage.set('jackett_key','');
				Lampa.Storage.set('jackett_interview','healthy');
				Lampa.Storage.set('parse_in_search',true);
				Lampa.Storage.set('parse_lang','lg');
			}
			if(Lampa.Storage.get('jackett_urltwo')=='jr_maxvol_pro'){
				Lampa.Storage.set('jackett_url','jr.maxvol.pro');
				Lampa.Storage.set('jackett_key','');
				Lampa.Storage.set('jackett_interview','all');
				Lampa.Storage.set('parse_in_search',true);
				Lampa.Storage.set('parse_lang','df');
			}
			if(Lampa.Storage.get('jackett_urltwo')=='jacred_ru'){
				Lampa.Storage.set('jackett_url','jac-red.ru');
				Lampa.Storage.set('jackett_key','');
				Lampa.Storage.set('jackett_interview','false');
				Lampa.Storage.set('parse_in_search',true);
				Lampa.Storage.set('parse_lang','lg');
			}
			if(Lampa.Storage.get('jackett_urltwo')=='jacred_viewbox_dev'){
				Lampa.Storage.set('jackett_url','jacred.viewbox.dev');
				Lampa.Storage.set('jackett_key','000');
				Lampa.Storage.set('jackett_interview','false');
				Lampa.Storage.set('parse_in_search',true);
				Lampa.Storage.set('parse_lang','lg');
			}
			if(Lampa.Storage.get('jackett_urltwo')=='jacred_pro'){
				Lampa.Storage.set('jackett_url','jacred.pro');
				Lampa.Storage.set('jackett_key','');
				Lampa.Storage.set('jackett_interview','all');
				Lampa.Storage.set('parse_in_search',true);
				Lampa.Storage.set('parse_lang','lg');
			}
			if(Lampa.Storage.get('jackett_urltwo')=='jac_black'){
				Lampa.Storage.set('jackett_url','jacblack.ru:9117');
				Lampa.Storage.set('jackett_key','777');
				Lampa.Storage.set('jackett_interview','false');
				Lampa.Storage.set('parse_in_search',true);
				Lampa.Storage.set('parse_lang','lg');
			}
		}

		Lampa.Settings.main({
			component:'parser',
			param:{
				name:'jackett_urltwo',
				type:'select',
				values:{
					'no_parser':'Без парсера',
					'jacred_xyz':'Jacred.xyz',
					'jr_maxvol_pro':'Jacred Maxvol Pro',
					'jacred_ru':'Jacred RU',
					'jacred_viewbox_dev':'Viewbox',
					'jacred_pro':'Jacred Pro',
					'jac_black':'Jac Black'
				},
				default:'jacred_xyz'
			},
			field:{
				name:'Выбор парсера',
				description:'Нажмите для выбора парсера из списка'
			},
			onChange:function(val){
				_0x4d128a();
				Lampa.Settings.update();
			},
			onRender:function(p){
				setTimeout(function(){
					$('div[data-children="parser"]').on('hover:enter',function(){
						Lampa.Settings.open();
					});
					if(Lampa.Storage.field('parser_use')&&Lampa.Storage.field('parser_torrent_type')=='jackett'){
						p.show();
						$('div[data-name="jackett_urltwo"]').insertAfter('div[data-name="jackett_url"]');
					}else p.hide();
				},100);
			}
		});

		Lampa.Storage.follow('parser_torrent_type',function(e){
			if(Lampa.Storage.get('parser_torrent_type')!=='jackett'){
				$('div[data-name="jackett_urltwo"]').hide();
			}else{
				$('div[data-name="jackett_urltwo"]').show();
				$('div[data-name="jackett_urltwo"]').insertAfter('div[data-name="jackett_url"]');
			}
		});

		var initTimer=setInterval(function(){
			if(typeof Lampa!=='undefined'){
				clearInterval(initTimer);
				if(!Lampa.Storage.get('jack',false)){
					Lampa.Storage.set('jack','true');
					Lampa.Storage.set('jackett_url','jacred.pro');
					Lampa.Storage.set('jackett_urltwo','jacred_xyz');
					Lampa.Storage.set('jackett_key','');
					Lampa.Storage.set('jackett_interview','healthy');
					Lampa.Storage.set('parse_in_search',true);
					Lampa.Storage.set('parse_lang','lg');
				}
			}
		},100);

		function _0x23ae4e(){
			var activity=Lampa.Activity.active().activity.name,
				parsers=[
					{title:'Jacred.xyz',url:'jacred.pro',url_two:'jacred_xyz',jac_key:'',jac_int:'healthy',jac_lang:'lg'},
					{title:'Jacred Maxvol Pro',url:'jr.maxvol.pro',url_two:'jr_maxvol_pro',jac_key:'',jac_int:'all',jac_lang:'lg'},
					{title:'Jacred RU',url:'jac-red.ru',url_two:'jacred_ru',jac_key:'',jac_int:'false',jac_lang:'lg'},
					{title:'Viewbox',url:'jacred.viewbox.dev',url_two:'jacred_viewbox_dev',jac_key:'000',jac_int:'false',jac_lang:'lg'},
					{title:'Jacred Pro',url:'jacred.pro',url_two:'jacred_pro',jac_key:'',jac_int:'all',jac_lang:'lg'},
					{title:'Jac Black',url:'jacblack.ru:9117',url_two:'jac_black',jac_key:'777',jac_int:'false',jac_lang:'lg'}
				];

			Promise.all(parsers.map(parser=>new Promise(resolve=>{
				var protocol=location.protocol==='https:'?'https://':'http://';
				if(parser.url=='jr.maxvol.pro')protocol='https://';
				var url=protocol+parser.url+'/api/v2.0/indexers/status:healthy/results?apikey='+(parser.jac_key||'');
				var xhr=new XMLHttpRequest();
				xhr.open('GET',url,true);
				xhr.timeout=3000;
				xhr.onload=function(){
					parser.title=xhr.status===200?'✔  '+parser.title:'✘  '+parser.title;
					resolve(parser);
				};
				xhr.onerror=xhr.ontimeout=function(){
					parser.title='✘  '+parser.title;
					resolve(parser);
				};
				xhr.send();
			}))).then(items=>{
				Lampa.Select.show({
					title:'Меню смены парсера',
					items:items,
					onBack:function(){Lampa.Controller.toggle(activity);},
					onSelect:function(item){
						Lampa.Storage.set('jackett_url',item.url);
						Lampa.Storage.set('jackett_urltwo',item.url_two);
						Lampa.Storage.set('jackett_key',item.jac_key);
						Lampa.Storage.set('jackett_interview',item.jac_int);
						Lampa.Storage.set('parse_lang',item.jac_lang);
						Lampa.Storage.set('parse_in_search',true);
						Lampa.Activity.toggle(activity);
						setTimeout(()=>{window.location.reload();},1000);
					}
				});
			});
		}

		var observer;
		Lampa.Listener.follow('app',function(e){
			if(e.name=='parser'||e.name=='history'){
				if(observer)observer.disconnect();
				observer=new MutationObserver(function(mutations){
					mutations.forEach(function(mutation){
						if($('div[data-children="parser"]').length&&Lampa.Storage.field('parser_torrent_type')=='jackett'){
							_0x23ae4e();
							observer.disconnect();
						}
					});
				});
				observer.observe(document.body,{childList:true,subtree:true});
			}
		});
	})();

})();
